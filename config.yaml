# =============================================================================
# Ronin Runtime Configuration
# =============================================================================
#
# This file controls HOW ronin runs (search parameters, scraping behaviour,
# timeouts, etc). Your personal profile (skills, resumes, preferences) lives
# in profile.yaml.
#
# Generated by: ronin setup
# Location: ~/.ronin/config.yaml
#
# =============================================================================

# -----------------------------------------------------------------------------
# Search Settings
# -----------------------------------------------------------------------------
search:
  # Keywords to search for on job boards
  # Use Seek-style OR syntax: '"keyword one"-or-"keyword two"'
  # Set your keywords during: ronin setup
  keywords: []

  location: "Victoria-VIC"                    # Job board location filter (e.g. "All-Australia", "Victoria-VIC", "Melbourne-VIC")
  date_range: 4                              # Days to look back

  salary:
    min: 0
    max: 400000

# -----------------------------------------------------------------------------
# Application Settings
# -----------------------------------------------------------------------------
application:
  # These override profile salary for form-filling (in case you want
  # to quote differently than your actual expectations)
  # Set during: ronin setup
  salary_min: 0
  salary_max: 0
  batch_limit: 100                           # Max jobs to apply to per run (0 = unlimited)
  queue_threshold: 0.15                      # Minimum (archetype_score * resume_alignment) for queueing

# -----------------------------------------------------------------------------
# Database (SQLite local by default; Postgres for split local/remote)
# -----------------------------------------------------------------------------
database:
  backend: "sqlite"                          # sqlite | postgres

  # Local spool DB used when Postgres is temporarily unavailable.
  # This is only used by the Local Agent (your machine), not the remote worker.
  spool_path: "data/spool.db"                # Relative paths are resolved under ~/.ronin/

  # For Postgres, prefer setting RONIN_DATABASE_DSN in ~/.ronin/.env.
  postgres:
    dsn: ""                                  # postgresql://user:pass@host:5432/ronin
    fallback_to_spool: true                   # If remote is down, keep working locally

# -----------------------------------------------------------------------------
# Scraping Settings
# -----------------------------------------------------------------------------
scraping:
  max_jobs: 0                                # 0 = unlimited
  delay_seconds: 1                           # Delay between requests (rate limiting)
  timeout_seconds: 10                        # HTTP request timeout
  quick_apply_only: true                     # Only process jobs with quick apply

# -----------------------------------------------------------------------------
# AI Analysis
# -----------------------------------------------------------------------------
analysis:
  min_score: 0                               # 0-100, jobs below this are filtered out
  feedback_min_samples: 2                    # Min resolved outcomes before feedback is injected into prompts
  enable_embeddings: true
  embedding_model: "all-MiniLM-L6-v2"

# -----------------------------------------------------------------------------
# Proxy (Optional)
# -----------------------------------------------------------------------------
proxy:
  enabled: false
  http_url: ""
  https_url: ""

# -----------------------------------------------------------------------------
# Notifications (Optional)
# -----------------------------------------------------------------------------
notifications:
  slack:
    webhook_url: ""                          # Or set SLACK_WEBHOOK_URL env var
    notify_on_error: true
    notify_on_warning: true
    notify_on_success: false

# -----------------------------------------------------------------------------
# Job Boards
# -----------------------------------------------------------------------------
boards:
  seek:
    enabled: true
    # Board-specific settings can go here

# -----------------------------------------------------------------------------
# Browser
# -----------------------------------------------------------------------------
browser:
  # "system" = use installed Chrome, "testing" = use Chrome for Testing
  # "camofox" = use camofox-browser server (for ECS/VPS headless deployments)
  mode: "system"
  # Override path (leave empty for auto-detection)
  chrome_path: ""
  # Camofox-browser server URL (only used when mode = "camofox")
  # Override with CAMOFOX_URL env var
  camofox_url: "http://localhost:9377"

# -----------------------------------------------------------------------------
# Schedule
# -----------------------------------------------------------------------------
schedule:
  enabled: false
  interval_hours: 2                          # How often to run search

# -----------------------------------------------------------------------------
# Closed-Loop Tracking (Optional)
# -----------------------------------------------------------------------------
tracking:
  gmail:
    enabled: false                           # If true, `ronin run` syncs Gmail outcomes after apply
    mailbox: "INBOX"
    lookback_days: 45
    query: "newer_than:45d application"
    auth_mode: "auto"                        # auto | local_server | console
    credentials_path: "credentials.json"
    token_path: "~/.ronin/gmail_token.json"
    max_messages_per_sync: 250

# -----------------------------------------------------------------------------
# Resume Variants (integrates existing ./resume repo)
# -----------------------------------------------------------------------------
resume_variants:
  repo_path: "resume"
  role_name: "data_engineer"

  # Which Seek profile name to use when running `ronin apply batch <archetype>`.
  seek_profile_mapping:
    builder: "default"
    fixer: "default"
    operator: "default"
    translator: "default"

  # Defaults mapped to current existing resume variants:
  # - b.yml / data_engineer_b.md (accurate/defensible)
  # - c.yml / data_engineer_c.md (ATS/keyword-heavy)
  # You can swap each archetype to dedicated builder/fixer/operator/translator files.
  archetype_mapping:
    builder:
      yaml: "yaml/data_engineer/builder.yml"
      markdown: "markdown/data_engineer_builder.md"
    fixer:
      yaml: "yaml/data_engineer/fixer.yml"
      markdown: "markdown/data_engineer_fixer.md"
    operator:
      yaml: "yaml/data_engineer/operator.yml"
      markdown: "markdown/data_engineer_operator.md"
    translator:
      yaml: "yaml/data_engineer/translator.yml"
      markdown: "markdown/data_engineer_translator.md"

# -----------------------------------------------------------------------------
# Seek Profile Automation (Optional / Advanced)
# -----------------------------------------------------------------------------
# This is separate from selecting which uploaded resume is attached per
# application. It switches your *Seek profile copy* (headline/summary/skills)
# so recruiter profile views match the archetype batch you are applying with.
#
# Requirements:
# - Playwright installed: `pip install playwright`
# - Browser installed: `playwright install chromium`
#
# Tip: run `ronin profile debug` to open Playwright Inspector and copy stable
# locators into `seek_profile.automation.selectors` if the defaults don't work.
seek_profile:
  automation:
    enabled: false
    headless: false
    channel: "chrome"                        # Prefer real Chrome for persisted sessions
    user_data_dir: "~/.ronin/chrome_profile" # Reuse Selenium login cookies if possible
    profile_url: "https://www.seek.com.au/profile"
    timeout_ms: 45000
    login_timeout_sec: 300
    slow_mo_ms: 0
    jitter: true
    min_delay_sec: 0.1
    max_delay_sec: 0.5

    # Optional: override individual element locators when Seek UI changes.
    # Keys used by the automation:
    # - edit_profile_button
    # - headline_edit_button / headline_input / headline_save_button
    # - summary_edit_button / summary_input / summary_save_button
    # - skills_edit_button / skills_input / skills_save_button
    # - skills_clear_button / skills_remove_buttons
    selectors: {}

  templates:
    builder:
      headline: ""
      summary: ""
      skills: []
      # headline_file: "assets/seek_profile/builder_headline.txt"
      # summary_file: "assets/seek_profile/builder_summary.txt"
      # skills_file: "assets/seek_profile/builder_skills.txt"
    fixer:
      headline: ""
      summary: ""
      skills: []
    operator:
      headline: ""
      summary: ""
      skills: []
    translator:
      headline: ""
      summary: ""
      skills: []

# -----------------------------------------------------------------------------
# Timeouts & Retry
# -----------------------------------------------------------------------------
timeouts:
  http_request: 30
  page_load: 45
  element_wait: 10
  implicit_wait: 10

retry:
  max_attempts: 3
  backoff_multiplier: 2.0
  jitter: true
